#              SNMP Configuration for APC UPSes.
#
# Global data should be tagged with 'global' at the second level, or
# equivalenty, with 'default'. The oid to determine the battery
# temperature is always the same, if we are querying an APC UPS, so
# OIDs are tagged as global.
#
# Data which is different for various entities should be tagged with a
# number. The appearance of a number rather than letter at the second
# level indicates characteristics which are unique to a single
# instance. While names for the multiple instances could in theory be
# meaningful, the existing code searaches for digits to differentiate
# global and local data.
#
# It is also possible to set a global characteristic and then override
# it on a local level. To test and demonstrate this, UPS 1 has it's
# own definition for snmp::reason for last transfer::values::1 ...
# Instead of 'No events', it uses 'Nothing happened' ... clearly a
# meaningless and insignificant difference. But using the debugger, we
# can display the snmp_apc_ups object and see the separate values.
#

# Each config file uses a unique prefix for data. Specify what that
# prefix is, so a single reading routine can handle all the different
# files.
#
name = snmp

# Agent metadata
#
snmp::db::table::battery capacity          = snmp_apc_ups
snmp::db::table::battery temperature       = snmp_apc_ups
snmp::db::table::battery runtime remaining = snmp_apc_ups
snmp::db::table::battery replace           = snmp_apc_ups
snmp::db::table::input voltage             = snmp_apc_ups
snmp::db::table::input frequency           = snmp_apc_ups
snmp::db::table::reason for last transfer  = snmp_apc_ups
snmp::db::table::output voltage            = snmp_apc_ups
snmp::db::table::output frequency          = snmp_apc_ups
snmp::db::table::output load               = snmp_apc_ups
snmp::db::table::output current            = snmp_apc_ups
snmp::db::table::comms                     = snmp_apc_ups
snmp::db::table::last self test result     = snmp_apc_ups
snmp::db::table::last self test date       = snmp_apc_ups
snmp::db::table::other                     = snmp_apc_ups
snmp::db::table::alerts                    = alerts

snmp::1::name      = an-u01
snmp::1::type      = APC UPS
snmp::1::ip        = 10.20.3.251
snmp::1::community = public

snmp::2::name      = an-u02
snmp::2::type      = APC UPS
snmp::2::ip        = 10.20.3.252
snmp::2::community = public

# specifications for the summary data & various attributes
#
snmp::global::summary::max        = 100
snmp::global::summary::ok         = 0
snmp::global::summary::warn       = 4
snmp::global::summary::hysteresis = 0

#snmp::global::oid::ups  type                 = .1.3.6.1.4.1.318.1.1.1.1.1.1.0
snmp::global::oid::battery capacity          = .1.3.6.1.4.1.318.1.1.1.2.2.1.0
snmp::global::oid::battery temperature       = .1.3.6.1.4.1.318.1.1.1.2.2.2.0
snmp::global::oid::battery runtime remaining = .1.3.6.1.4.1.318.1.1.1.2.2.3.0
snmp::global::oid::battery replace           = .1.3.6.1.4.1.318.1.1.1.2.2.4.0
snmp::global::oid::input voltage             = .1.3.6.1.4.1.318.1.1.1.3.2.1.0
snmp::global::oid::input frequency           = .1.3.6.1.4.1.318.1.1.1.3.2.4.0
snmp::global::oid::reason for last transfer  = .1.3.6.1.4.1.318.1.1.1.3.2.5.0
snmp::global::oid::output voltage            = .1.3.6.1.4.1.318.1.1.1.4.2.1.0
snmp::global::oid::output frequency          = .1.3.6.1.4.1.318.1.1.1.4.2.2.0
snmp::global::oid::output load               = .1.3.6.1.4.1.318.1.1.1.4.2.3.0
snmp::global::oid::output current            = .1.3.6.1.4.1.318.1.1.1.4.2.4.0
snmp::global::oid::comms                     = .1.3.6.1.4.1.318.1.1.1.8.1.0
snmp::global::oid::last self test result     = .1.3.6.1.4.1.318.1.1.1.7.2.3.0
snmp::global::oid::last self test date       = .1.3.6.1.4.1.318.1.1.1.7.2.4.0

snmp::global::battery capacity::units      = %
snmp::global::battery capacity::min        = 0
snmp::global::battery capacity::max        = 100
snmp::global::battery capacity::ok         = 25
snmp::global::battery capacity::warn       = 10
snmp::global::battery capacity::hysteresis = 1
snmp::global::battery capacity::weight     = 1
snmp::global::battery capacity::compare    = greater

# http://koninkx.net/index.php/howtos/snmp/8-usefull-oids-for-apc says
# this can be F or C depending on configuration, but APC MIB file says
# it is Celsius.
#
snmp::global::battery temperature::units      = degrees C
snmp::global::battery temperature::min        = 0
snmp::global::battery temperature::max        = 100
snmp::global::battery temperature::ok         = 20
snmp::global::battery temperature::warn       = 25
snmp::global::battery temperature::hysteresis = 1
snmp::global::battery temperature::weight     = 1
snmp::global::battery temperature::compare    = lesser

snmp::global::battery runtime remaining::units      = minutes?
snmp::global::battery runtime remaining::min        = 0
snmp::global::battery runtime remaining::max        = 50
snmp::global::battery runtime remaining::ok         = 50
snmp::global::battery runtime remaining::warn       = 49
snmp::global::battery runtime remaining::hysteresis = 1
snmp::global::battery runtime remaining::weight     = 1
snmp::global::battery runtime remaining::compare    = greater

snmp::global::battery replace::values::1        = unneeded
snmp::global::battery replace::values::2        = needed
snmp::global::battery replace::weight     = 1
 
snmp::global::input voltage::units      = V
snmp::global::input voltage::min        = 90
snmp::global::input voltage::max        = 150
snmp::global::input voltage::ok_min     = 105
snmp::global::input voltage::ok_max     = 125
snmp::global::input voltage::warn_min   = 95
snmp::global::input voltage::warn_max   = 140
snmp::global::input voltage::crisis_min = 90
snmp::global::input voltage::crisis_max = 150
snmp::global::input voltage::hysteresis = 1
snmp::global::input voltage::weight     = 1

snmp::global::input frequency::units      = Hz
snmp::global::input frequency::min        = 55
snmp::global::input frequency::max        = 65
snmp::global::input frequency::ok_min     = 58
snmp::global::input frequency::ok_max     = 62
snmp::global::input frequency::warn_min   = 56
snmp::global::input frequency::warn_max   = 64
snmp::global::input frequency::crisis_min = 55
snmp::global::input frequency::crisis_max = 65
snmp::global::input frequency::hysteresis = 1
snmp::global::input frequency::weight     = 1

snmp::global::reason for last transfer::values::1  = No events
snmp::global::reason for last transfer::values::2  = High line voltage
snmp::global::reason for last transfer::values::3  = Brownout
snmp::global::reason for last transfer::values::4  = Los of mains power
snmp::global::reason for last transfer::values::5  = Small temporary power drop
snmp::global::reason for last transfer::values::6  = Large temporary power drop
snmp::global::reason for last transfer::values::7  = Small spike
snmp::global::reason for last transfer::values::8  = Large spike
snmp::global::reason for last transfer::values::9  = UPS self test
snmp::global::reason for last transfer::values::10 = Excessive input voltage fluctuation
snmp::global::reason for last transfer::weight     = 1

# test/demonstrate local override of global setting
#
snmp::1::reason for last transfer::values::1  = Nothing happened.

snmp::global::output voltage::units      = V
snmp::global::output voltage::min        = 90
snmp::global::output voltage::max        = 150
snmp::global::output voltage::ok_min     = 115
snmp::global::output voltage::ok_max     = 130
snmp::global::output voltage::warn_min   = 110
snmp::global::output voltage::warn_max   = 135
snmp::global::output voltage::crisis_min = 90
snmp::global::output voltage::crisis_max = 150
snmp::global::output voltage::hysteresis = 1
snmp::global::output voltage::weight     = 1

snmp::global::output frequency::units      = Hz
snmp::global::output frequency::min        = 55
snmp::global::output frequency::max        = 65
snmp::global::output frequency::ok_min     = 58
snmp::global::output frequency::ok_max     = 62
snmp::global::output frequency::warn_min   = 56
snmp::global::output frequency::warn_max   = 64
snmp::global::output frequency::crisis_min = 55
snmp::global::output frequency::crisis_max = 65
snmp::global::output frequency::hysteresis = 1
snmp::global::output frequency::weight     = 1

snmp::global::output load::units      = %
snmp::global::output load::min        = 0
snmp::global::output load::max        = 100
snmp::global::output load::ok         = 75
snmp::global::output load::warn       = 95
snmp::global::output load::hysteresis = 1
snmp::global::output load::weight     = 1

snmp::global::output current::units      = A
snmp::global::output current::min        = 0
snmp::global::output current::max        = 5
snmp::global::output current::ok         = 4
snmp::global::output current::warn       = 4.7
snmp::global::output current::hysteresis = 0.1
snmp::global::output current::weight     = 1

snmp::global::comms::label      = Communicating
snmp::global::comms::values::1  = yes
snmp::global::comms::values::2  = no
snmp::global::comms::weight     = 5
